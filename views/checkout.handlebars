
<div class="content">
    <!--Main Row-->
    <div class=row>
        <!--Left Column For Cart/Total Information-->
        <div class="costpage col-md-7">

            <!-- Center Page break-->



            <div class="cartBreakdown row">
                <h2>Cart:</h2>



                <!-- ORDER SUMMARY ---->




                <!-- Horizontal Page break-->
                <div class="horz_line"></div>
            </div>




            <div class="cartTotal row">
                <div class="col-sm-12">

                    <div class="row totalTitle ">
                        <div class="col-sm-12">
                            <h2>Order Summary:</h2>
                        </div>
                    </div>
                    <div class="row subTotal">
                        <div class="col-sm-12">
                            <div class="subTotalTitle">
                                <p>Sub-Total:</p>
                            </div>
                            <div class="subTotalPrice">$7.20</div>
                        </div>
                    </div>
                    <div class="row tax">
                        <div class="col-sm-12">
                            <div class="taxTitle">
                                <p>Tax:</p>
                            </div>
                            <div class="taxPrice">$0.52</div>

                        </div>
                    </div>
                    <div class="lineBreak row">
                        <div class="col-sm-1"></div>
                        <div class="col-sm-10">
                            <div class="lightHorzLine"></div>
                        </div>
                        <div class="col-sm-1"></div>
                    </div>

                    <div class="row orderTotal">
                        <div class="col-sm-12">
                            <div class="orderTotalText">
                                <p>Order Total:</p>
                            </div>
                            <div class="orderTotalPrice">$0.52</div>

                        </div>
                    </div>




                </div>


                <!-- Right Vertical line-->
                <div class="horz_line_order"></div>
            </div>
        </div>

        <!--Right Column For Checkout Information-->
        <div class="col-md-5">
            <div class="vert_line"></div>
            <div id="paymentArea">
               <!-- <form action="/charge" method="post" id="payment-form">
                    <div class="form-row">
                         <label for="card-element">
                                 Credit or debit card
                        </label>
                         <div id="card-element">
                            <!-- A Stripe Element will be inserted here. -->
              <!--            </div>

                         <!-- Used to display Element errors. -->
             <!--           <div id="card-errors" role="alert"></div>
                    </div>

                    <button>Submit Payment</button>
                </form>-->
               <!-- <div class="paymentTitle row">
                    <div class="col-sm-12">
                        <h2> Payment:</h2>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputEmail4">Name on Card:</label>
                        <input type="email" class="form-control" id="inputEmail4">
                    </div>
                    <div class="form-group col-md-6">

                        <label for="inputState">Where to Pay:</label>
                        <select id="inputState" class="form-control">
                            <option selected>In Store</option>
                            <option>Credit Card</option>


                        </select>

                    </div>
                </div>
                <div class="form-group">
                    <label for="inputAddress">Card Number</label>
                    <input type="text" class="form-control" id="inputAddress" placeholder="">
                </div>



                <div class="row">
                    <div class="col-md-3">

                        <label for="inputState">Month</label>
                        <select id="inputState" class="form-control">
                            <option selected month="1">Jan</option>
                            <option month="2">Feb</option>
                            <option month="3">Mar</option>
                            <option month="4">Apr</option>
                            <option month="5">May</option>
                            <option month="6">Jun</option>
                            <option month="7">Jul</option>
                            <option month="8">Aug</option>
                            <option month="9">Sep</option>
                            <option month="10">Oct</option>
                            <option month="11">Nov</option>
                            <option month="12">Dec</option>


                        </select>
                    </div>
                    <div class="col-md-3">

                        <label for="inputState">Year</label>
                        <select id="inputState" class="form-control">
                            <option selected year="2020">2020</option>
                            <option year="2021">2021</option>
                            <option year="2022">2022</option>
                            <option year="2023">2023</option>
                            <option year="2024">2024</option>
                            <option year="2025">2025</option>
                            <option year="2026">2026</option>
                            <option year="2027">2027</option>




                        </select>
                    </div>
                    <div class="col-md-6">

                        <label for="cardCCV">CCV</label>
                        <input type="text" class="form-control" id="CCV" placeholder="xxx">
                    </div>

                </div>




                <div class="form-group">
                    <label for="inputAddress">Card Number</label>
                    <input type="text" class="form-control" id="inputAddress" placeholder="">
                </div>

                <div class="form-group">
                    <label for="inputAddress">Address</label>
                    <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St">
                </div>
                <div class="form-group">
                    <label for="inputAddress2">Address 2</label>
                    <input type="text" class="form-control" id="inputAddress2"
                        placeholder="Apartment, studio, or floor">
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputCity">City</label>
                        <input type="text" class="form-control" id="inputCity">
                    </div>

                    <div class="form-group col-md-2">
                        <label for="inputZip">Zip</label>
                        <input type="text" class="form-control" id="inputZip">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary" id = "submitButton"
                    style="background-color: #9cd6c0; border-color:#9cd6c0">Send Order</button>
                </form>

            </div>

        </div>-->

    </div>


</div>

<script>




function startPageFunc(){
    //var stripe = Stripe('pk_test_6gYsUNSU5JDFJRODslrNMawa00mPv9Q73R');
    $.ajax({
        method: "POST",
        url: "/checkout/getOrderItems",
       // data: { userId:1}
        
    }).done(function (response) {
            console.log(response);
            $(".subTotalPrice").html(`$${response[0].subtotal}`)
            const taxes = response[0].subtotal*.075;
            $(".taxPrice").html(`$${taxes.toFixed(2)}`)
            const total = (response[0].subtotal + taxes)
            $(".orderTotalPrice").html(`$${total.toFixed(2)}`)
            for(orderItems in response){
                 let currentSubItemList = ""
                console.log(response[orderItems].addons)
                let currentAddons = JSON.parse(response[orderItems].addons);
                console.log(currentAddons)
            $.ajax({
               method: "POST",
               url: "/checkout/getProduct",
               data: { productId:response[orderItems].productId}
        
            }).then(function(product){ 
            
               
            for (let addon =0 ;addon<currentAddons.length;addon++) {
                for (ans in currentAddons[addon].question.answers){
                
                console.log(currentAddons);
                console.log(currentAddons[addon].question.answers[ans].title)
                let currentText = `<div class='row subItem'><p class='leftText text1'>${currentAddons[addon].question.answers[ans].title}</p><p class='rightText text2'>$${currentAddons[addon].question.answers[ans].price}</p></div>`
                    console.log(currentText)
                        currentSubItemList += currentText;
                }
                    }
                    console.log(currentSubItemList)

                   
                $(".cartBreakdown").append(`<div class='item row' id='item_${orderItems}'><p class='itemname itemName${orderItems}' state='closed'>${product.name}<i class='fas fa-caret-right'></i></p><p class='itemPrice'>$${product.basePrice} </p><div class='itemizedList'> ${currentSubItemList}  </div></div>`)


            
            } ).then(function(){
                    $(".itemName"+orderItems).on("click", function (event) {
                        let state = $(event.target).attr("state");
                        if (state === "open") {
                            $(event.target).attr("state", "closed")
                            $(event.target).parent().children(".itemizedList").css("height", "0px").css("padding", "0px")
                            $(event.target).parent().children(".itemizedList").css("margin-bottom", "0px");
                            $(event.target).children("i").css("transform", "rotate(0deg)")
                        } else {
                            $(event.target).attr("state", "open")
                    
                            let sectionHeight = $(event.target).parent().children(".itemizedList")[0].scrollHeight;
                    
                            $(event.target).parent().children(".itemizedList").css("height", (sectionHeight + 10) + "px").css("padding", "0px");
                            $(event.target).parent().children(".itemizedList").css("margin-bottom", "40px");
                            $(event.target).children("i").css("transform", "rotate(90deg)")
                        }
                       ///////////////////////////////////////////////STRIPE///////////////////////////////////////////
                       /*  var elements = stripe.elements();
                        // Custom styling can be passed to options when creating an Element.
                         var style = {
                            base: {
                                // Add your base input styles here. For example:
                                     fontSize: '16px',
                                     color: '#32325d',
                            },
                         };

                     // Create an instance of the card Element.
                        var card = elements.create('card');

                    // Add an instance of the card Element into the `card-element` <div>.
                        card.mount('#card-element');*/
                       /////////////////////////////////////////////////////////////////////////////////////////////////
                    
                    });
                });
            }
                    
        })
    }




document.addEventListener("DOMContentLoaded", function(event) { 
startPageFunc()

});

</script>